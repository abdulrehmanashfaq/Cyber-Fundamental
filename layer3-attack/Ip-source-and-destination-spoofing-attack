Network Traffic Analysis: IP Spoofing & DoS Attacks

This guide covers common network-layer attacks involving IP Source and Destination spoofing, focusing on detection patterns and mitigation strategies.
üõ°Ô∏è Core Analysis Principles

When analyzing traffic, apply the Subnet Trust Rule:

    Inbound: Any packet entering the network with a source IP from inside the local subnet is likely a spoofed/crafted packet.

    Outbound: Any packet leaving the network with a source IP not belonging to the local subnet indicates internal malicious activity or unauthorized packet crafting.

üîç Attack Profiles & Detection
1. Decoy Scanning (Nmap -D)

Attackers hide their scanning IP among multiple "decoy" addresses to evade IDS/Firewall blocking.

    How it Works: The target receives probes from many IPs (decoys) simultaneously. Only one is the attacker.

    The "Reveal": For closed ports, the victim sends a TCP RST packet. The attacker's machine is the only one that will consistently receive and track these responses to map the network.

    Detection Indicators:

        Initial fragmentation from fake/unusual addresses.

        Legitimate TCP traffic mixed with high-volume probes.

        A single external host receiving an unusually high volume of RST flags from the victim.

2. Random Source DDoS

A denial-of-service attack where the attacker rapidly changes the source IP of every packet to overwhelm state tables and resources.

    Reverse Smurf Logic: Can appear as many "ghost" hosts pinging a single host, or a victim host sending replies to non-existent IPs.

    Detection Indicators:

        Single Port Utilization: Massive traffic directed at one specific service port (e.g., 80, 443) from thousands of different IPs.

        Incremental Base Ports: Attack tools often use a sequential (non-random) source port for each new spoofed IP.

        Identical Length Fields: Packet payloads are often exactly the same size, unlike organic user traffic.

3. LAND Attacks (Local Area Network Denial)

A classic DoS where the source and destination addresses are forged to be identical.

    Mechanism: Source IP:Port == Destination IP:Port.

    Impact: Forces the victim into an infinite loop of responding to itself, leading to CPU exhaustion or system crashes.

    Detection: Filter for packets where ip.src == ip.dst.

4. SMURF Attacks

An amplification attack using ICMP (Ping) traffic.

    The Flow:

        Attacker sends ICMP Request to a network broadcast address.

        The Source IP is spoofed to be the Victim's IP.

        Every host on that network segment sends an ICMP Reply to the victim.

    Detection: Look for an "Echo Reply Storm"‚Äîan excessive amount of ICMP replies hitting a host that never sent the initial requests.

5. IV Generation (Wireless Attack)

Specific to WEP (Wired Equivalent Privacy) networks.

    Goal: Capture and re-inject modified packets to force the generation of Initialization Vectors (IVs) for statistical cracking.

    Detection: High volume of identical/repeated packets between two hosts in a short timeframe.

üõ†Ô∏è Traffic Analysis Commands (tcpdump/tshark)
Extracting Unique Source IPs

To see if you are being hit by a Random Source attack:
Bash

# tcpdump: Extract unique IPs from a capture
tcpdump -nn -r analysis.pcap | awk '{print $3}' | cut -d. -f1-4 | sort | uniq -c | sort -nr

Filtering for ICMP Requests (Smurf/Ping Floods)
Bash

# tshark: List top IPs sending ICMP Echo Requests
tshark -r analysis.pcap -Y "icmp.type == 8" -T fields -e ip.src | sort | uniq -c | sort -nr

Detecting LAND Attacks
Bash

# Filter for packets where source and destination IPs are the same
tcpdump -r analysis.pcap "src host [Victim_IP] and dst host [Victim_IP]"

üõ°Ô∏è Prevention Strategies

    Ingress/Egress Filtering: Implement RFC 2827 (BCP 38) to drop packets with spoofed source addresses at the network boundary.

    uRPF (Unicast Reverse Path Forwarding): Discard packets if the source IP is not reachable through the interface it arrived on.

    Stateful Inspection: Configure Firewalls to reconstruct fragmented packets and validate the 3-way handshake before allowing traffic to internal services.

    ICMP Rate Limiting: Restrict the number of ICMP responses a host can generate per second.
